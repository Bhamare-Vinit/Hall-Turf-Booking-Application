{"ast":null,"code":"var _jsxFileName = \"/home/nu11thr3ad/Desktop/Reservation Booking/src/pages/Checkout.jsx\",\n    _s = $RefreshSig$();\n\n// @ts-check\nimport React, { useEffect, useContext, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { Container, Col, Row, Card, Button } from \"react-bootstrap\";\nimport { useShoppingCart } from \"use-shopping-cart\";\nimport formatPrice, { formatValue } from \"../utils/formatPrice\";\nimport AuthContext from \"../context/auth/authContext\";\nimport styled from \"styled-components\";\nimport RemoveFromCart from \"../components/RemoveFromCart\";\nimport { FaTimes } from \"react-icons/fa\";\nimport * as ROUTES from \"../constants/routes\";\nimport axios from \"axios\";\nimport toast from \"react-hot-toast\";\nimport { useStripe } from \"@stripe/react-stripe-js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Styled = styled.div`\n  .background-photo {\n    background: black;\n    overflow: hidden;\n    background: -webkit-linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),\n      url(\"https://image.freepik.com/free-vector/young-people-standing-near-cashier-grocery-store-counter-payment-buyer-flat-vector-illustration-food-meal-products_74855-8742.jpg\");\n    object-fit: contain;\n    background-size: contain;\n  }\n`;\n_c = Styled;\n\nconst Checkout = () => {\n  _s();\n\n  const {\n    cartCount,\n    formattedTotalPrice,\n    cartDetails,\n    totalPrice,\n    clearCart\n  } = useShoppingCart();\n  const authContext = useContext(AuthContext);\n  const cartItems = Object.keys(cartDetails).map(key => cartDetails[key]);\n  const history = useHistory();\n  const stripe = useStripe();\n  const [disabled, setDisabled] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const clearFullCart = () => {\n    clearCart();\n    localStorage.setItem(\"date\", \"\");\n    localStorage.setItem(\"book\", \"\");\n    localStorage.setItem(\"time\", \"\");\n    history.push(ROUTES.BOOKING);\n  };\n\n  const fetchCheckoutSession = async ({\n    quantity,\n    amount,\n    email\n  }) => {\n    const book = {\n      quantity,\n      amount,\n      email\n    };\n    return axios.post(\"/checkout-sessions\", book).then(res => {\n      return res.data;\n    });\n  };\n\n  const handleClick = async event => {\n    setIsLoading(true);\n    setDisabled(true);\n\n    if (cartCount === 0 && totalPrice === 0 && cartItems.length === 0) {\n      setDisabled(true);\n      setIsLoading(false);\n      return toast.error(\"Cart is empty. Please select items\");\n    } // if (totalPrice < 500000) {\n    //   setDisabled(true);\n    //   setIsLoading(false);\n    //   return toast.error(\"Please select the Turf or Auditorium\");\n    // }\n\n\n    const {\n      sessionId\n    } = await fetchCheckoutSession({\n      quantity: 1,\n      amount: totalPrice,\n      email: localStorage.getItem(\"email\")\n    });\n    const {\n      error\n    } = await stripe.redirectToCheckout({\n      sessionId\n    });\n    setIsLoading(false);\n\n    if (error) {\n      console.log(\"error\", error);\n    }\n  };\n\n  useEffect(() => {\n    document.title = \"Checkout | BookIt\";\n    authContext.loadUser();\n    setIsLoading(false);\n    setDisabled(false); // eslint-disable-next-line\n  }, []);\n  return /*#__PURE__*/_jsxDEV(Styled, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"background-photo\",\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        className: \"p-5\",\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: \"m-5 p-3 border-0 shadow-lg\",\n          style: {\n            backgroundColor: \"#f1f5f9\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(Row, {\n            className: \"m-3\",\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              md: 3\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 106,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 6,\n              children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-center\",\n                children: \"Cart Summary\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-right\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  \"aria-label\": \"Clear Cart\",\n                  title: \"Clear Cart\",\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    onClick: clearFullCart,\n                    className: \"text-center\",\n                    variant: \"light\",\n                    children: [\"Clear Cart \", /*#__PURE__*/_jsxDEV(FaTimes, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 118,\n                      columnNumber: 34\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 113,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 112,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 111,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Row, {\n            className: \"ml-3\",\n            children: /*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: cartCount === 1 ? cartCount + \" Cart Item : \" : cartCount + \" Cart Items : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Row, {\n            className: \"mx-3 my-0\",\n            children: [cartItems.map(cartItem => {\n              const price = formatPrice(cartItem);\n              const value = formatValue(cartItem);\n              return /*#__PURE__*/_jsxDEV(Col, {\n                md: 12,\n                className: \"my-3\",\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    className: \"text-left\",\n                    md: 6,\n                    children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                      children: cartItem.title\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 141,\n                      columnNumber: 25\n                    }, this), cartItem.title !== \"Auditorium\" && cartItem.title !== \"Turf\" ? /*#__PURE__*/_jsxDEV(RemoveFromCart, {\n                      addon: cartItem\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 144,\n                      columnNumber: 27\n                    }, this) : null]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 140,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    className: \"text-right\",\n                    md: 6,\n                    children: /*#__PURE__*/_jsxDEV(Row, {\n                      className: \"text-muted text-right\",\n                      children: [/*#__PURE__*/_jsxDEV(Col, {\n                        className: \"mx-0 text-left px-0\",\n                        children: /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"mx-0\",\n                          children: price\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 150,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 149,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        className: \"mx-0 text-center px-0\",\n                        children: /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"mx-0\",\n                          children: \"*\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 153,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 152,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        className: \"mx-0 text-center px-0\",\n                        children: /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"mx-0\",\n                          children: cartItem.quantity\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 156,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 155,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        className: \"mx-0 text-center px-0\",\n                        children: /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"mx-0\",\n                          children: \" = \"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 159,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 158,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(Col, {\n                        className: \"mx-0 text-right px-0\",\n                        children: /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"mx-0\",\n                          children: [\" \", value, \" \"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 162,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 161,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 148,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 147,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 139,\n                  columnNumber: 21\n                }, this)\n              }, cartItem.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 138,\n                columnNumber: 19\n              }, this);\n            }), /*#__PURE__*/_jsxDEV(Col, {\n              className: \"text-left mt-3\",\n              md: 6,\n              children: /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"font-weight-bold\",\n                children: \"Total Price :\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              className: \"text-right mt-3\",\n              md: 6,\n              children: /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"text-right font-weight-bold\",\n                children: formattedTotalPrice\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Row, {\n            className: \"m-3\",\n            children: /*#__PURE__*/_jsxDEV(Col, {\n              className: \"text-right mt-3 ml-5\",\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                style: {\n                  backgroundColor: \"#6772E5\",\n                  color: \"#FFF\",\n                  padding: \"8px 12px\",\n                  border: 0,\n                  borderRadius: \"4px\",\n                  fontSize: \"1em\"\n                },\n                disabled: disabled // @ts-ignore\n                ,\n                onClick: handleClick,\n                children: isLoading ? \"Processing...\" : \"Checkout\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 181,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Checkout, \"GUat8EauK86VedCMxGOZeHYuO+8=\", false, function () {\n  return [useShoppingCart, useHistory, useStripe];\n});\n\n_c2 = Checkout;\nexport default Checkout;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Styled\");\n$RefreshReg$(_c2, \"Checkout\");","map":{"version":3,"sources":["/home/nu11thr3ad/Desktop/Reservation Booking/src/pages/Checkout.jsx"],"names":["React","useEffect","useContext","useState","useHistory","Container","Col","Row","Card","Button","useShoppingCart","formatPrice","formatValue","AuthContext","styled","RemoveFromCart","FaTimes","ROUTES","axios","toast","useStripe","Styled","div","Checkout","cartCount","formattedTotalPrice","cartDetails","totalPrice","clearCart","authContext","cartItems","Object","keys","map","key","history","stripe","disabled","setDisabled","isLoading","setIsLoading","clearFullCart","localStorage","setItem","push","BOOKING","fetchCheckoutSession","quantity","amount","email","book","post","then","res","data","handleClick","event","length","error","sessionId","getItem","redirectToCheckout","console","log","document","title","loadUser","backgroundColor","cartItem","price","value","id","color","padding","border","borderRadius","fontSize"],"mappings":"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","sourcesContent":["// @ts-check\nimport React, { useEffect, useContext, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { Container, Col, Row, Card, Button } from \"react-bootstrap\";\nimport { useShoppingCart } from \"use-shopping-cart\";\nimport formatPrice, { formatValue } from \"../utils/formatPrice\";\nimport AuthContext from \"../context/auth/authContext\";\nimport styled from \"styled-components\";\nimport RemoveFromCart from \"../components/RemoveFromCart\";\nimport { FaTimes } from \"react-icons/fa\";\nimport * as ROUTES from \"../constants/routes\";\nimport axios from \"axios\";\nimport toast from \"react-hot-toast\";\nimport { useStripe } from \"@stripe/react-stripe-js\";\n\nconst Styled = styled.div`\n  .background-photo {\n    background: black;\n    overflow: hidden;\n    background: -webkit-linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),\n      url(\"https://image.freepik.com/free-vector/young-people-standing-near-cashier-grocery-store-counter-payment-buyer-flat-vector-illustration-food-meal-products_74855-8742.jpg\");\n    object-fit: contain;\n    background-size: contain;\n  }\n`;\n\nconst Checkout = () => {\n  const {\n    cartCount,\n    formattedTotalPrice,\n    cartDetails,\n    totalPrice,\n    clearCart,\n  } = useShoppingCart();\n  const authContext = useContext(AuthContext);\n  const cartItems = Object.keys(cartDetails).map((key) => cartDetails[key]);\n  const history = useHistory();\n  const stripe = useStripe();\n  const [disabled, setDisabled] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const clearFullCart = () => {\n    clearCart();\n    localStorage.setItem(\"date\", \"\");\n    localStorage.setItem(\"book\", \"\");\n    localStorage.setItem(\"time\", \"\");\n    history.push(ROUTES.BOOKING);\n  };\n\n  const fetchCheckoutSession = async ({ quantity, amount, email }) => {\n    const book = {\n      quantity,\n      amount,\n      email,\n    };\n\n    return axios.post(\"/checkout-sessions\", book).then((res) => {\n      return res.data;\n    });\n  };\n\n  const handleClick = async (event) => {\n    setIsLoading(true);\n    setDisabled(true);\n    if (cartCount === 0 && totalPrice === 0 && cartItems.length === 0) {\n      setDisabled(true);\n      setIsLoading(false);\n      return toast.error(\"Cart is empty. Please select items\");\n    }\n    // if (totalPrice < 500000) {\n    //   setDisabled(true);\n    //   setIsLoading(false);\n    //   return toast.error(\"Please select the Turf or Auditorium\");\n    // }\n    const { sessionId } = await fetchCheckoutSession({\n      quantity: 1,\n      amount: totalPrice,\n      email: localStorage.getItem(\"email\"),\n    });\n    const { error } = await stripe.redirectToCheckout({\n      sessionId,\n    });\n    setIsLoading(false);\n    if (error) {\n      console.log(\"error\", error);\n    }\n  };\n\n  useEffect(() => {\n    document.title = \"Checkout | BookIt\";\n    authContext.loadUser();\n    setIsLoading(false);\n    setDisabled(false);\n    // eslint-disable-next-line\n  }, []);\n\n  return (\n    <Styled>\n      <div className=\"background-photo\">\n        <Container className=\"p-5\">\n          <Card\n            className=\"m-5 p-3 border-0 shadow-lg\"\n            style={{ backgroundColor: \"#f1f5f9\" }}\n          >\n            <Row className=\"m-3\">\n              <Col md={3}></Col>\n              <Col md={6}>\n                <h3 className=\"text-center\">Cart Summary</h3>\n              </Col>\n              <Col md={3}>\n                <div className=\"text-right\">\n                  <p aria-label=\"Clear Cart\" title=\"Clear Cart\">\n                    <Button\n                      onClick={clearFullCart}\n                      className=\"text-center\"\n                      variant=\"light\"\n                    >\n                      Clear Cart <FaTimes />\n                    </Button>\n                  </p>\n                </div>\n              </Col>\n            </Row>\n            <Row className=\"ml-3\">\n              <Col>\n                <p>\n                  {cartCount === 1\n                    ? cartCount + \" Cart Item : \"\n                    : cartCount + \" Cart Items : \"}\n                </p>\n              </Col>\n            </Row>\n            <Row className=\"mx-3 my-0\">\n              {cartItems.map((cartItem) => {\n                const price = formatPrice(cartItem);\n                const value = formatValue(cartItem);\n                return (\n                  <Col key={cartItem.id} md={12} className=\"my-3\">\n                    <Row>\n                      <Col className=\"text-left\" md={6}>\n                        <h6>{cartItem.title}</h6>\n                        {cartItem.title !== \"Auditorium\" &&\n                        cartItem.title !== \"Turf\" ? (\n                          <RemoveFromCart addon={cartItem} />\n                        ) : null}\n                      </Col>\n                      <Col className=\"text-right\" md={6}>\n                        <Row className=\"text-muted text-right\">\n                          <Col className=\"mx-0 text-left px-0\">\n                            <span className=\"mx-0\">{price}</span>\n                          </Col>\n                          <Col className=\"mx-0 text-center px-0\">\n                            <span className=\"mx-0\">*</span>\n                          </Col>\n                          <Col className=\"mx-0 text-center px-0\">\n                            <span className=\"mx-0\">{cartItem.quantity}</span>\n                          </Col>\n                          <Col className=\"mx-0 text-center px-0\">\n                            <span className=\"mx-0\"> = </span>\n                          </Col>\n                          <Col className=\"mx-0 text-right px-0\">\n                            <span className=\"mx-0\"> {value} </span>\n                          </Col>\n                        </Row>\n                      </Col>\n                    </Row>\n                  </Col>\n                );\n              })}\n              <Col className=\"text-left mt-3\" md={6}>\n                <h5 className=\"font-weight-bold\">Total Price :</h5>\n              </Col>\n              <Col className=\"text-right mt-3\" md={6}>\n                <h5 className=\"text-right font-weight-bold\">\n                  {formattedTotalPrice}\n                </h5>\n              </Col>\n            </Row>\n            <Row className=\"m-3\">\n              <Col className=\"text-right mt-3 ml-5\">\n                <Button\n                  style={{\n                    backgroundColor: \"#6772E5\",\n                    color: \"#FFF\",\n                    padding: \"8px 12px\",\n                    border: 0,\n                    borderRadius: \"4px\",\n                    fontSize: \"1em\",\n                  }}\n                  disabled={disabled}\n                  // @ts-ignore\n                  onClick={handleClick}\n                >\n                  {isLoading ? \"Processing...\" : \"Checkout\"}\n                </Button>\n              </Col>\n            </Row>\n          </Card>\n        </Container>\n      </div>\n    </Styled>\n  );\n};\n\nexport default Checkout;\n"]},"metadata":{},"sourceType":"module"}